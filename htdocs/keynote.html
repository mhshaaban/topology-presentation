<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Let's talk about topology</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/solarized.css" id="theme">
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <script>
if( window.location.search.match( /print-pdf/gi ) ) {
  var link = document.createElement( 'link' );
  link.rel = 'stylesheet';
  link.type = 'text/css';
  link.href = 'css/print/pdf.css';
  document.getElementsByTagName( 'head' )[0].appendChild( link );
}
    </script>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>


    <script src="/js/qrcode.min.js"></script>
    <script src="/js/d3.v3.min.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script src="/lib/js/lodash.min.js"></script>
    <style>
.chart rect {
  fill: steelblue;
}
                        .chart text {
                          fill: white;
                          font: 10px sans-serif;
                          text-anchor: end;
                        }

                        .axis text {
                          font: 10px sans-serif;
                        }

                        .axis path,
                        .axis line {
                          fill: none;
                          stroke: #000;
                          shape-rendering: crispEdges;
                        }
    </style>					
  </head>

  <body>
    <div class="reveal">
      <div class="slides">


        <section data-state='cover' data-background-size="cover" data-background-image="/img/techsys.png" data-background-position="top">
          <h2>Anticiper l'avenir...</h2>
          <blockquote cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
            &ldquo;Sois le changement que tu veux voir dans le monde. - Ghandi&rdquo;
          </blockquote>
          <h5>Techsys : Expertises et Innovations</h5>
          <p><small>June 1, 2016</small></p>
        </section>

        <section data-state="slideJoin" id="slideJoin">
          <h5>Please join the keynote:</h5>
          <div>
            <a href="http://localhost" id="demourl">url</a>
          </div>
          <center>
            <div id="qrcode"></div>
          </center>

          <a href="javascript:void(0)" class="add-data action-button">Add data</a>

          <div id="demo" style="text-align: center;">
          </div>
          <div id="slideJoinContainer"></div>
          <script type="text/javascript">
var demourl = window.location.protocol +'//'+ window.location.hostname+':'+window.location.port;
document.getElementById("demourl").innerHTML = demourl;
document.getElementById("demourl").href = demourl;
new QRCode(document.getElementById("qrcode"), {
  text: demourl,
  width: 128,
  height: 128,
});
JSONData = [
{ "id": 1, "created_at": "Mon May 13 2013", "amount": 2000},
{ "id": 1, "created_at": "Mon May 13 2013", "amount": 2000},
{ "id": 2, "created_at": "Thu Jun 06 2013", "amount": 17000},
{ "id": 4, "created_at": "Thu May 09 2013", "amount": 15000},
{ "id": 5, "created_at": "Mon Jul 01 2013", "amount": 16000}
]


Reveal.addEventListener( 'slideJoin', function() {
  (function() {
    var data = JSONData.slice()
      var format = d3.time.format("%a %b %d %Y")
      var amountFn = function(d) { return d.amount }
    var dateFn = function(d) { return format.parse(d.created_at) }

    var x = d3.time.scale()
      .range([10, 280])
      .domain(d3.extent(data, dateFn))

      var y = d3.scale.linear()
      .range([180, 10])
      .domain(d3.extent(data, amountFn))

      var svg = d3.select("#demo").append("svg:svg")
      .attr("width", 300)
      .attr("height", 200)
      var refreshGraph = function() {
        x.domain(d3.extent(data, dateFn))
          y.domain(d3.extent(data, amountFn))

          var circles = svg.selectAll("circle").data(data)

          circles.transition()
          .attr("cx", function(d) { return x(dateFn(d)) })
          .attr("cy", function(d) { return y(amountFn(d)) })

          circles.enter()
          .append("svg:circle")
          .attr("r", 4)
          .attr("cx", function(d) { return x(dateFn(d)) })
          .attr("cy", function(d) { return y(amountFn(d)) })
          .attr( { r: 8, fill: 'green' });
      }


    d3.selectAll(".add-data")
      .on("click", function() {
        var start = d3.min(data, dateFn)
          var end = d3.max(data, dateFn)
          var time = start.getTime() + Math.random() * (end.getTime() - start.getTime())
          var date = new Date(time)

          obj = {
            'id': Math.floor(Math.random() * 70),
            'amount': Math.floor(1000 + Math.random() * 20001),
            'created_at': date.toDateString()
          }
        data.push(obj)
          refreshGraph()
      })


    var ws = new WebSocket("wss://localhost:8080/slideJoin");

    //var data = [];

    ws.onmessage = function(evt) {
      // append new data from the socket
      data.push(JSON.parse(evt.data));
      refreshGraph()
    };

    refreshGraph()

  })();


  //  var height = 250, width = 800;
  //  var svg = d3.select("#slideJoinContainer").selectAll('svg').data([0]).enter().append("svg")
  //    svg.attr( {width: width, height: height });
  //  var data = new Array(250);
  //
  //  function randomizeData() {
  //    for (var i = data.length - 1; i >= 0; i--) {
  //      data[i] = { id: Math.random(), x: Math.random()*width, y: Math.random()*height }
  //    };
  //  }
  //
  //  update();
  //
  //  function update() {
  //    randomizeData();
  //
  //    var circles = svg.selectAll('circle').data(data); 
  //
  //    circles
  //      .transition().duration(500)
  //      .attr('r', 3)
  //      .transition().duration(1500)
  //      .attr('cx', function(d) { return d.x; })
  //      .attr('cy', function(d) { return d.y; })
  //      .transition().duration(500)
  //      .attr('r', 8)
  //
  //      circles.enter().append('circle')
  //      .attr('cx', function(d) { return d.x; })
  //      .attr('cy', function(d) { return d.y; })
  //      .attr( { r: 8, fill: 'green' });
  //  }
  //
  //  svg.on('click', update);
  //
  //var updateEvent = setInterval(update, 2000);

  // Reveal.addEventListener( 'slidechanged', function(event) {
  // 	console.log(event.previousSlide.id);
  // 	if (event.previousSlide.id !== 'slideJoin') return;
  // 	clearInterval(updateEvent);
  // });

} );

          </script>					
        </section>

        <section>
          <h2>The End</h2>
        </section>

      </div>
    </div>

    <script>

// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
  controls: true,
  progress: true,
  history: true,
  center: true,

  // width: 1024,
  // height: 768,
  // margin: 0.0,
  // minScale: 1.0,
  // maxScale: 1.0,

  theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
  transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

  // Parallax scrolling
  // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
  // parallaxBackgroundSize: '2100px 900px',

  // Optional libraries used to extend on reveal.js
  dependencies: [
  { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
  { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
  { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
  { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
  { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
  { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});
// d3.select(self.frameElement).style("height", "768px");
    </script>

  </body>
</html>

